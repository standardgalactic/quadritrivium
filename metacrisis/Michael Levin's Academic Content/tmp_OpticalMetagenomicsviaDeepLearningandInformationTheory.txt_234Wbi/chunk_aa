Thank you very much for inviting me to talk. I'll talk about my PhD research
Yeah, it's a
Been hard times in last last days for Israel. I'm sure everybody heard
but I'm happy to
To to give this talk in any case despite the hard the hard times
so
Yeah, so optical metagenomics very deep learning and information theory. This is the this is the topic of my PhD research
and
under the supervision of your chef man professor of chef man from techno and
You buy a bench day and tell we've university
collaboration with a tiny a copy in your vineyard near vine burger from computer science in techno and many other
Many other wonderful people that help with this research
so
I'll I'll talk about first of all, let's define
Metagenomics
Which is the analysis of the entire genomic information in a sample from an environment
Okay now
That that is that is in contrast to
You know like genomic traditional genomics, which takes and amplifies a specific
section of a genome or for specific organs
now
the motivation
For this research for me personally was cultivation free bacteria identification. I'll talk about it
But there are many other uses of the technology and in general of metagenomics
I'll talk about the technology itself about optical genome mapping
I'll talk about
the computational advancements we did using deep learning and information theory for actual optimization of
the method
Right, so feel free to stop me if something isn't clear
So for the motivation
bacterial infection diagnostics nowadays is pretty slow
And sadly many people die because it takes days to cultivate bacteria from blood samples, for example
Until you can actually identify the bacteria and
Prescribe the correct antibiotic despite all the antibiotic resistance that
Happened today with many bacteria
Identification today is done by either phenotyping with different growth media
mass spectrometry on the proteins inside the bacteria
By PCR directed to specific species or in very rare cases also sequencing
But all those require cultivation
So you have because they're not sensitive enough to actually just either analyze the very few
genomic material of the pathogen in the sample directly or
Deal with the low quantity of cells of the pathogen inside
so so something else should be
to be done and
for this I I looked at optical genome mapping as a technology because it provides a way to
observe single molecules of DNA and
Map them to genome references and that way we can actually take a single molecule of DNA and identify which organism it came from
So the definition of the technology is mapping optical images of
linearized and label DNA fragments to reference genome sequences
Okay, and here you can see an example image of
the of a DNA molecule
With which so essentially this is a double strand which we can't see of course in a microscope
But we do see fluorophores that are touched along that the double strand
it's tenons of microns in length and
Multiple thousands of base pair in in length
So it has been demonstrated by different research groups for either structural variation detections in the human genome for
Translocations reverse cells insertions in the chromosomes and of course for microbial species and indication
but
The technology is limited in accuracy and in actual utility today
Because of challenges I'll present both on the experimental side and the computational side and
My aim in my PhD research was to
Make those like solve those challenges and make this technology useful and maybe being used for
Things such as pathogen identification and diagnostics
So advantages of this technology over sequencing
Is first of all extremely long genome maps which
For applications in human genomics. It's very important for study of structural variation, etc
much higher sensitivity potentially
because
of a very simple protocol
Compared to the old process that is needed
For for sequencing by synthesis by
When when you have to essentially do shotgun sequencing at certain
So that's the reason it's a single molecule technique. So that's that's the main advantage
So how to do optical genome mapping first of all we have to linearize DNA
so
There are two ways
That we tried in our lab one on the left you can see that we take
Activated glass surface. Here is me holding a pipette and dragging a droplet
containing
DNA of a bacteria of E. Coli in this case
dragging it on on on a glass surface and
On the left you can see a microscopy image we took and you can see the DNA molecules
It's just stretching in straight lines on the glass due to the motion another way is a chip we used from banana genomics
It it contains thousands of nano channels
Into which DNA molecules can go and linearize
By the application of pressure and electric field. So that's two ways by which you can linearize DNA molecules
But also to create those images you have to label them because otherwise
You won't see anything and you have to reflect information about genome
So there are multiple ways to label DNA for
optical genome mapping
One on the left you see as the enzyme based labeling so and we'll focus on this kind of labeling in the stock mainly
So one way is to
Is to use a nicking enzyme which looks for four or six letter patterns on the
genome sequence
Nicks one of the strands and then a DNA polymerase incorporates a fluorophore there a fluorescent base pair
base and
Another way is to use material transferases which just search for a pattern and with a modification of a cofactor introduce a floor for
add specific sequence patterns another way is affinity based labeling by which you can for example
Stain only GC base pairs by
denaturation, which is
GC or AT selective or by using some other interpolating
Molecule which prevents which has affinity for AT base pairs and this way fluorophores
Only stain the GC base pairs those GC base pairs
so that that's another way to reflect information about the genome and
Image it in a fluorescent regular fluorescence microscope, right?
So the resulting OGM data we have
consists of
Microscopy images
Like this one. So we take a field of view and we see many DNA molecules each line here is a DNA molecule of
Tens of kilobase potentially hundreds of kilobase
length and the dots are the fluorophores that attach at the pattern we
Wanted to label and this is a zoom into one of those molecules
And
On the right and the data also consists of reference genome sequences
And there are tens of thousands of bacteria beings that already has been sequenced by humanity and in general hundreds of thousands of organisms
So we have plenty of data now. We have to match between
Between these images and genome sequences
Also, we have the knowledge of the the sequence pattern we labeled for example here
We see okay, let's if we label the pattern CTT AG on the double-stranded DNA
Then we can actually essentially build a database of reference positions in each of those sequences
So we can map between those images to to those sequences
Yeah, but there are many challenges
so
on the experimental side and
Total internal reflection microscopy is needed
Because the signal is very low. I don't know if you're familiar with this
but but that's that's a macroscopic method that allows to filter out the noise from the background and
Only capture light from very close to the cover sleep
And that's important which induces some experimental challenges the labeling enzymes
have
sometimes low efficiency and and we need them to label only what we are looking for and not
Anything we're not looking for and this could be a challenge. So the this has to be developed
for each enzyme and
Long enough DNA fragments are needed because we're imaging them with light and fluorescence microscopy
and
The linear the linearization of the DNA on the surface also has questionable yield
So you have to make sure that all of them or many of them actually stick and linearize and that's also a challenge
um
On the computational side, which is the main thing I focused in my
research project
Accuracy nowadays for OGM before our advancements is too low for short DNA fragments
And and and noise from different biochemical and photo physical effects
Like enzyme labeling efficiency and floor for
So inter
Inter-effect between neighboring floor force etc. Are not accounted for in the algorithms and
This reduces accuracy
Also, non-uniform stretching of DNA molecules is also a big problem
Which makes it hard to map them to genome sequences and the computation time is pretty significant
especially when you are imaging a
large volume of
DNA and you want to map against let's say the whole
The genome sequences of all known organisms. So I addressed all those challenges
Um
Yeah, let me know up the knife anything is not clear about like the method or introduction
Anybody has any questions?
Alright, so let's go on
so
The first fall we developed a deep learning model that
allows this mapping problem of
Images of DNA to genome sequences
Alright, so our goal is to map an image of DNA molecule to a genome sequence
So we have the reference genome
We know where the positions of the label the pattern. Let's say I'd labeled the but six letter pattern CTT
AAG and
And I know the positions now I get the image. I have to map it
Go over all the possible genome sequences
I know and and match it to the one which is it's most matching to and in the right position. So both ways
and we train this
convolutional neural net to
predict the positions from the images and
Then another algorithm that aligns and I will talk about it that aligns it to the reference gene and
The resulting accuracy here, you can see the comparison
We get essentially so the important line is this one and the blue line and we get twice more
Accuracy versus the state of the art for 50 kilobase
fragments
Which is significant?
Yeah, and so how did we make this model? How do you train it?
So first of all, we considered the simulated data first of all
In which all the different effects
That we could model were incorporated a labeling efficiency of the enzyme off-target labeling
point-spread function meaning
The optical spread of each fluorophore is significant. You see it's not just a dot. It's not just one pixel. It's it's a block
right because
resolution is limited, of course
And dependent on the on the wavelength of flight, of course and the numerical aperture of the objective
And the stretching of the DNA molecule so all those things were simulated and
and
The neural net learned to predict the exact
locations of
each fluorophore in such an image and
so the in green are the ground truth and the blue are the predicted positions which
Is pretty accurate
Given the fact that you hear for example, you have a fluorophore which is actually two fluorophores
overlapped on the same location
but from the shape of the of the
Resulting a blob of light and the neural net is able to discern that there are actually two fluorophores there
Which is very important for increasing the accuracy and extracting as much more information from
the genome from the from the DNA molecule to the genome sequence
The last function I will not go into details unless anybody is really interested and can go back into that and explain the loss function used
And then then we have the alignment algorithm
