Hi guys, my name is Christoph Harle, I'm a PhD student from Switzerland doing computational
biology and right now I'm in the big game of my PhD so like fourth year and I'm going
to tell you something about a multi-mode of spatial temporal phenotyping of human retinal
organoid development so like a lot of punchlines in here like buzzwords and I'm from the group
of Great Camp and there are also like a developmental biology group doing also a lot of
computational biology and we just like two years ago we moved to the Institute of Human
Biology which is a Roche founded institute which is like focusing on developing organoid
systems and like bringing organoids to the point where they can actually be used to farm
for like safety testing, model improvements, drug screens and stuff like this and yeah
today I mainly focus on this paper we published like almost a year ago by now and if I have
time later on I will also like show what I've been doing since then like on the computational
sites like the tools I developed for this stuff here how I like improved it and applied it
to some other data systems but let's see how we go time wise. So maybe just for starters
like a tiny introduction to organoids so what are organoids? So in principle like organoids
allow you like to either from like tissue derived cells or there's like inducible prune
stem cells, take them, seed them in a culture, in a 3D environment like most of them like
using a matrix for example and applying like the right morphogen compositions and chemical
stuff and adding some time then in the end like you have like a self-emergent system
which is like really recapitulating phenotypes of the actual real tissue you derive from
or like you use like certain morphogen to push it into a certain fate of a tissue and
for example here this would just like be a cartoon of a intestinal organoids where you
have like the crypts and the gut and I mean this we basically did for the eye so let's
hear the disclaimer and in addition to this, okay, in addition to this like what we are
aiming to do is like really from the multi-omics perspective look at such developing systems.
So what we are doing mainly in our lab is like we do a lot of single cell sequencing on RNA,
also attack and multi-oomplator and also a lot of multiplex imaging. So mainly in
unistochemistry data sets where we can like reach flexibility of like 60 antibodies or even up to 100
antibodies on every piece. And my main task here was then like to bring like such data sets where
you like have a temporal component and this like multimodal component but from different
experiments together in like one representation so like working on like digital multi-omic
representations of components. So the whole like reaching this like endpoint of multimodal
special temporal integration. So in the case of the retina what we are doing is we take
MIPCCs and then grow them into retinal organoids and keep them in culture over time
course from over 39 weeks so it's pretty long time so congrats to like the retina people there.
So like I have to maybe like quickly notify like I didn't do like any retina myself so like
there were like two postdocs being involved in this like one guy just like optimizing the
whole imaging and sample handling and that was Philip Bali and Giovanna Barcati who did
like all the sequencing which I will be presenting here. And another postdoc she's on Hay who also
had with the computational hotel who was more focused on the single cell data and I was more
focused on the imaging data. But here what you can see like our approach is like we grow these
organoids and we also have like primary tissue sections and then we place them on a 96 wells
structure and then we do this like reiterative round of staining so like we always put three
antibodies on top, we also dabby staining, image the thing, elude, repeat, rinse and repeat
over like a month. And then we come up with this like very beautiful data set where we
really go from like kind of really like millimeter scale to nanometer scale with 40x confocal
imaging with like oil and everything is like really really nice imaging quality and already
like just from the protein stains you can see that like the structure you would normally see
in an eye like having like cones and rods on the outside having the muller glee or the retina
ganglion cells, americant cells, bipolar cells, you all have them like nicely spatially
organized in the same way as you would have them in the adult retina for example. So this
is the primary tissue here and that's a slice from one of our organoids. So in total like
in this data set I guess we had like 45 stains and up to like 30 or so organoid slices so
rather big data set actually. And now just like an overview here like it's a lot of data
so like you cannot really grasp like the all the images and just like making sense of just
creating overlays that's overwhelming to many mutations in there. So what we came up with
is that we perform a multiplex tissue humans analysis and this is kind of like informed
or like inspired by what we do in senus RNA sequencing where like you would have like one cell
in this case it's just a pixel and then like on this like n-dimensional space of features
in this case the protein states in senus RNA it would be like the transcriptome you perform
a clustering, unsupervised clustering. And that's what you see here. So like each color
here would correspond to like one pixel cluster and then if we then like put these colored
pixels regarding for the clusters back into the image we come up with such representations
where we actually get like biological meaningful clustering of the system. So you would have
an MTU which is marking molecular nuclei, one MTU which is marking immigrant cells. You
do see like collagen deposits in the system. You see cones and rods and stuff like this
and the cool thing here is that I mean we have like the complete time course of data right.
Like we have we can actually see like this laminated structure of the retina forming up
over the time course. So like here we start from six weeks it's like a little bit disorganized
and then around like 18 weeks you already start getting a sense of the lamination here over
24 weeks to the final endpoint in our data set which was like 39 weeks. And this data
point is then like super close to the actual like primary system. But I mean after all this
is like just like it's not quantitatively looking at the data it's just like getting it
into another representation and like making sense of it from your like biological knowledge
you have right. But what we actually wanted to do is like really put numbers onto like
the developmental state of the system from week six to week 39. And how we actually did
this is like we thought like okay we have this very stereotypic spatial organization
on the outer layer of the organoids which is corresponding to the privatization that we see.
So and what we're doing now is like that's mainly my part here that I developed this algorithm
called Laminator because we laminated stuff and we on the outline of the organoids we basically
just place rectangles oriented to the center of the organoid. And then we read like along
this axis like the inner outer axis of the laminar windows we read out the intensity
profiles from all the proteins gets together. And from this information then we are able
to reconstruct super time trajectories like falling back to like and diffusion map algorithms
for example. And this allows us then to like reconstruct a trajectory which reflects the
development of the system. And then you can like just show it by making collages of these
MPU images for like different time points for example where you can see like it's nicely
ordered and those structures make sense. Or like having the complete overview by like
creating heat maps over this trajectory and then looking at either MPUs or just like
nuclei states for example like here the first state for the nuclei that's like in the beginning
it's very disorganized and over time it's like really forming this double layer like the
inner and outer place. And then like if you put numbers on this then you can say like
okay we can come up with a maturation score and we show that the later time points of the
organoids are actually like becoming closer in their composition of the laminar structure
with the primary tissue which are like here the red dots.
So PT or not X-axis is time or?
Yeah 2 to time.
Good.
Yeah so like just like ordering and finding a path through the diffusion space and then
ordering the points in there. It's mainly just like yeah that's like the embedding for
the diffusion maps and then you see like the 2 to time which you calculate in this
label.to. This is here now like just like zooming into the algorithm I mean mainly what
you get is like from all these laminar windows you come up with like for each
protein state like you have like this, you can say like a time signal but I mean it's
in space but like just like that and then I mean I do some like processing like I
eat a down sample I smooth the signals and then as you can imagine like in the
case if you want to do this like globally in the complete data set it's becoming big
because in the end what you want to come up with is like a one dense distance matrix
and this is computational intensive so what I found like that like comparing these
signals in n dimensional space it's not very effective if you do it with cross correlation
but rather just like first transforming it into Fourier space and then Fourier space
with receding distances and then use these distance matrices to then run the diffusion
map algorithm for example and then I mean in this space you can also like answer
like twice clustering and I mean this already helps you just like because organoids
can be messy they can be like there's the variability is high so we can already use
this algorithm to like just like assess that which regions of the organoids
should be interesting for us to compare to the primary tissue.
Yeah it is it is but just like computation really it's it's big up because like the Fourier
transform it was like in Python's limit you can see and it was just convenient to use.
Now bringing in like CMOS data so she sang and did this whole...
Before you go on I just want to make sure I understand what you've done so what you're doing
is a slight cross-section of your organoid and then you're looking at the intensive
profiles of the different channels, different stains that you have and then you're quantifying
that and seeing how that changes spatially across that section and that will tell you
whether your organoid is at its final destination.
Exactly, exactly.
There's this diffusion thing that you kind of asked me about.
The diffusion maps it's called it's a dimension reduction method but it's like
comparison to PCA it's non-linear so like yeah you're trying to find an embedding due to like
diffusion processes which describes your data that's not linear but okay cool.
Okay so and next step here would then be like that we have like integrated atlas or
fraternal organoids but from the transcriptomic side so we have like attack data in there
and we have RNA-seq data in there for the complete time course and I mean there like
just from the cell stains you can also construct trajectories that like from the
progenitor cells here like these develop a tumular glia, anion cells,
americans cells, B-polar cells like all the cell types I've already shown you can also see
in the transcriptomic space.
Funnily like the human projection of the whole thing is a dog so I don't know what this
is about vision but so that was now like the data set we wanted to combine with our
spatial data set and sorry and like also like from the attack data here of course
you can like reconstruct gene regulatory networks and then also show like which
gene programs for which cell type are active which certain vectors are there like
getting like a very complete picture of the system.
And now like coming to the actual integration so like our idea was like to use RNA as our
anchor data set because I mean for each protein we pretty much know like which RNA transcript
would be responsible for its production and the attack can be mapped to the RNA because
like you have like certain gene regions you know the gene body corresponds to a certain
transcript so like that's the linkage like the RNA is our perfect point where we can
do like our data integration.
And then for the actual integration we just used like SORRA like a standard processing
pipeline in the single cell world where you mainly like by overlapping features like for
the protein at the RNA you do some KNN graphs and then you by finding mutual neighbors you
can just like transfer our labels over.
But I mean this worked pretty pretty good in our case so like for each time point of our
organized data we put label transfer first like the cell type labels and then also like
bringing over the complete transcript by just like if you apply super high resolution clustering
in the RNA space and then you transfer these labels and then you can just like take the
average expression for each gene in these higher resolution metaclusters and visualize them
then back into the statistics like then you can see that like for certain key regulators
like transcription factors of the retina they like perfectly nicely in the right layer of
the organoid you can see that like the cell type composition of the whole thing is making
sense so we are pretty happy with that.
However some more stuff yeah sorry and so like now I mean I told you that we had all these
windows right and now we also know like the position of each nuclei in each of these windows
so we can actually now like visualize like our map transcriptome or like attacks peaks
or just the cell types in this pseudo temporal space and then you can see that like certain
steps at the beginning are just like everywhere and narrowing down or just like I'm not present
anymore finding the right place in the light in the layers stuff like this so like now we
have like really integrated data set which we can also like analyze in this trajectory
basically.
So and I mean up to then here this was like our first submission and then the reviewers
were like yeah but you make an assumption like RNA and protein and it's not always the same
so for this we went back then and sent some tissue slides to a company called
or what the name but they were doing like basically Merfish's service so we collected
some organoid slices on fresh frozen tissue performed multiplexed fish and then my quest
was like okay now we have to bring like yet another data set into the whole integrated
thing so how we did this is actually we again like we used these like windows again as our
like reference coordinate system where we say okay like first of all I can basically do
the same analysis as I did for the 4I data and then ask which profiles I observe in the
myoscope the transcript stuff is like referring to the predicted RNA profiles I've seen before
and then match these and I mean this is then like what you can see here like I mean in the
fish data we had two time points week 13 and week 32 and week 32 was like most closely
related to week 24 and a little bit better less to week 39 and the week 13 was close to
the week 12 and the fish data so that was already pretty promising then I mean for some
for some key regulators and then you can just like look at these profiles along the window
and see that fish and the 4I these are like very much nicely correlated and then the next
step is that you can actually show that the 4I and the fish integrate as good with the
actual single cell RNA-seq data by basically then in these windows doing like nuclei
matching so like you find like the best two matching windows and then you say like okay
I have a nuclear nucleus from 4I here it's in the upper region okay so like good partners
for this also nuclei in the upper region of fish data you match these and then you just
like do correlation and then you can see that like for transcripts which are high expressed
like the predictions were pretty well for transcripts which are actually low expressed
it's not very good but I mean this is also like if you just integrate the fish data with
the RNA-seq data there like the predictions are also not good if you have like low transcript
counts basically you have a lot of noise and your predictability is just like going down
and in the end we just ask okay like how nicely can each of these datasets like the fish or
the 4I resolve the actual single cell RNA-seq data by just like clustering the single cell
RNA-seq in higher and higher resolution and then letting like the matched nucleus saying
okay like can they still distinguish like this resolution of clustering and the RNA-seq
data and then we've seen that like both the 4I and the fish data perform similarly well
