Then outside of that, I've got a title and a theme.
And in my theme, I'm passing a bit of transparency
and I'm making the point size the markers of the scatter plot
quite big with 10 pixels.
Let's have a look at the output of this beautiful plot.
It's going to take a second or two again
because it's now also creating this linear model behind the scenes.
So I'm not even using a package that does linear modeling.
They exist too, GLM being a beautiful example of that.
But just inside of this plotting package,
GATFLY, I can do this.
And then I can see my two models
both for the placebo and the active group.
I see my markers with a bit of transparency
and I see my two linear models
created with a confidence interval around those.
That is absolutely fantastic
and those plots are really beautiful.
Let's do some inferential statistics.
Now, with inferential statistics,
we always start off by describing our data.
Now, we've already done that
and the one that I'm going to concentrate on here
is just to see what's the difference in HDL cholesterol
from the difference mean before and after
but between the two groups.
So we've just got the subtraction
of what the before minus after,
that gives me one variable
and I've got that same variable split
along one of my categorical variables, which is the group.
So I'm just asking a question.
Is there a statistically significant difference
in the change in cholesterol?
So my null hypothesis is that
there is no difference between those two
and my alternate hypothesis is
that there is a change between the two.
So one can be higher than the other
and I'm using an alpha value of 0.05.
So there's my hypotheses.
So let's just describe the placebo group.
Remember, we created these two sub-data frames.
Let's just go back to the REPL to see the results.
I'm describing HDL cholesterol
from my placebo data frame.
So that's another way to go about it.
You need to use the query to select these.
Just create two sub-data frames,
one for each of your groups
and that's what we did in the beginning.
So I have my placebo and my intervention group
and there we can see summary statistics.
The mean of the difference was negative 0.1
for the placebo group
and negative 0.22 there
for the, so there was a bigger decrease
in the HDL cholesterol
in the time period before and after the intervention.
We can also just ask for the following.
So I'm asking for confidence intervals.
So that comes from the hypothesis tests function
package.
There's a confint function
and what I'm going to do is call the one sample
t-test function also from hypothesis tests
on each of my two,
each of my two data sets,
the HDL cholesterol delta for each of my two groups.
So I've got the mean
and I can work out the standard deviation
but here we have the 95% confidence interval
around the means for both of these.
So very simple for us to use hypothesis tests
just for confidence intervals.
I've really plotted these two distributions for you.
So let's just have a look at our assumptions
for the use of parametric tests.
So in hypothesis tests
there is a p-value function
and what I want to do,
it does not have a Shapiro-Wolk test
but it has comograph Smirnov
and I think a few others.
So I'm just going to use ks-test here.
So exact one sample ks-test
and I'm passing my cholesterol delta
for the placebo group
and against a normal distribution.
So that's a ks-test
against a normal distribution.
So let's do that.
It's going to give me back a p-value.
So the null hypothesis, remember,
is that it is from a population
in which this variable is normally distributed
and let's do the same for my second group
and there we have a problem.
We see that a p-value of less than
and chosen alpha value of 0.05
so we're not really there
meeting the assumptions for the use of a parametric test.
I can investigate that visually
by qqplot.
So let's just have a look at this.
I'm creating two plots p1 and p2
and each of these are going to be a qqplot.
So in the x-axis I have the values
and on the y-axis
we have the theoretical distribution there.
So I'm calling distributions.normal
and it's all going to be changed by this
stat.qq.
So it knows what to do,
what to do with the values for a qqplot
and then geom.point
so it's scatterplot
and then a semicolon
because I don't want any output to the screen
I'm going to do that same for the intervention group
and then we're going to call getfly.vstack
so I could also just say vstack
because we said using getfly.
So vstack, plot 1 and plot 2
so make a vertical stack of those two plots
and then the plots I can see a vertical stack
of these two qqplots
I can see here for the second one
that's really off of a straight line there
for normal
so we're not really meeting the assumptions
for the use of parametric tests
and although this data was taken
from the normal distribution when we created this
we only took 23 points from each
so there's always the chance
that we get random values
that are not going to show up to be from a normal distribution.
So in that case
for two groups
the symmetric test will be the Man-Whitney-U test
and of course there is a Man-Whitney-U test there
I'm just passing my two data sets
my placebo's changing cholesterol
and my intervention changing cholesterol
using the dot notation
so it's going to give me two arrays
that's what we like with the Man-Whitney-U test
and I want the p-value back from there
so let's have a look at the Man-Whitney-U test
gives me a p-value of 0.7 there
so that is above my
alpha value of 0.5
so we can't reject another hypothesis there
just to show you that we also have an
equal variance t-test
so if we did meet the assumptions with the use of a parametric test
there we see equal variance t-test
is another function
and we can run that but we're going to see
a p-value
that is also above 0.05
so no problems there
last thing on today's list
I'm going to show you just how to do a chi-square test
for independence
there is no such function in the hypothesis test data
for any of the packages of yet
so we're going to do this by hand
so I hope you know the equation
for working out a chi-square value
we're just going to sum over the square differences
between observed and an expected contingency table
and then divide that by the expected values
and that gives us our chi-square value
and then we're just going to use a chi-square distribution
as far as the degrees of freedom are concerned
so let's create a frequency table
a contingency table of observed values
and what we're going to use is the
freq tables function
package.freq table
frequency table function there
and what I want is the data frames
and I want group against gender
those are two categorical variables remember
we changed them to categorical variables
but what I want back is not a data frame
I want it to be converted to a straight up array
so I'm going to use the convert function
change to array the following thing for me
this frequency table and I'm going to store that
in gg underscore obs
that's my contingency table of observed values
and what we get back is this 2 by 2 array
of my observed values
and that's what you want for your
for your chi-square test for independence
and you can see it's 64 bit integers
but I have two dimensions now
